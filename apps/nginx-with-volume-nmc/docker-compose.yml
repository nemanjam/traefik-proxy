version: '3.8'

services:
  nginx-with-volume-nmc:
    image: nginx:stable-alpine3.17-slim
    container_name: nginx-with-volume-nmc
    volumes:
      - ./website:/usr/share/nginx/html
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
    networks:
      - proxy
    labels:
      - 'traefik.enable=true'
      - 'traefik.docker.network=proxy'
      - 'traefik.http.routers.nginx-with-volume-nmc.rule=Host(`${TRAEFIK_SITE_HOSTNAME}`)'
      - 'traefik.http.routers.nginx-with-volume-nmc.entrypoints=websecure'
      - 'traefik.http.routers.nginx-with-volume-nmc.service=nginx-with-volume-nmc'
      - 'traefik.http.services.nginx-with-volume-nmc.loadbalancer.server.port=8080'

networks:
  proxy:
    external: true
